# Nauty Laman plugin
A plugin for the utility program `geng` provided with [Nauty](http://pallini.di.uniroma1.it/) that enables quick generation of nonisomorphic [sparse and tight graphs](https://en.wikipedia.org/wiki/Dense_graph#Sparse_and_tight_graphs).


## Installation
1. Clone this repo.
2. Download and build [Nauty](http://pallini.di.uniroma1.it/).
3. `geng` has to be rebuilt with the flag `-D'PLUGIN="<path to this repo>/prunelaman.h"'` to inject the plugin. Edit the `makefile` for Nauty accordingly and rebuild `geng` (e.g. `rm -f geng && make geng`). The entry for `geng` in the `makefile` could look something like this:
```makefile
geng : ${GTOOLSH} <path to this repo>/prunelaman.h geng.c gtoolsW.o \
		nautyW1.o nautilW1.o naugraphW1.o schreier.o naurng.o
	${CC} -o geng ${CFLAGS} -D'PLUGIN="<path to this repo>/prunelaman.h"' \
		${W1} geng.c gtoolsW.o nautyW1.o nautilW1.o naugraphW1.o schreier.o \
		naurng.o ${LDFLAGS}
```
4. Once `geng` is compiled the executable can be copied to the `nauty-laman-plugin` folder to benefit from the included scripts.


## Usage
The plugin adds a few new parameters to `geng`:
* `-K#`: generate (k,l)-tight graphs where l = k(k+1)/2. Minimum degree and number of edges will default to k and kn-l, respectively. Sparse graphs can be generated by manually providing the minimum and maximum number of edges (e.g. `0:999`). In that case, the minimum degree will default to zero.
* `-L#`: provides the l when generating (k,l)-sparse or (k,l)-tight graphs.
* `-H`: generate (k,l)-tight graphs constructible by [Henneberg type I moves](https://en.wikipedia.org/wiki/Laman_graph#Henneberg_construction). k defaults to 2 but can be set using `-K#`. l is always k(k+1)/2.
* `-N#`: all graphs with this number of nodes or fewer are considered sparse (defaults to floor(k)). This value will automatically be increased if doing so does not affect the result.

Both `-K` and `-L` accept rational numbers making it possible to generate, e.g., (3/2,2)-tight graphs (see results below). Note, however, that denominators equal to their numerator are ignored, e.g., `-K2/2` is equivalent to `-K2`. If rational arguments are not needed, define the macro `INT_KL` before compiling for a small increase in performance.


## Results - counts and execution times
The tables below show the execution time when generating graphs for various number of vertices n. Unless otherwise specified, the tests were run on an 6-core/12-thread Intel® Core™ i7-6800K CPU @ 3.40GHz. Extensions to entries in [OEIS](https://oeis.org/) are marked with *(new)*.


### Laman graphs
OEIS entry: [A227117](https://oeis.org/A227117 "Number of minimally rigid graphs in 2D on n vertices.")<br/>
Command: `geng $n -K2 -u`

[Laman graphs](https://en.wikipedia.org/wiki/Laman_graph), minimally rigid graphs in 2D, are exactly the (2,3)-tight graphs. When increasing n by one, for large n, the number of graphs increases by a factor of approximately 30 while the execution time increases by a factor of approximately 60. `geng` parallelizes well over physical cores but poorly over logical cores.
n                     |     11    |     12     |        13       |    14 (new)    |      15 (new)     |
----------------------|:---------:|:----------:|:---------------:|:--------------:|:-----------------:|
Laman graphs          | 2 039 273 | 44 176 717 |  1 092 493 042  | 30 322 994 747 | 932 701 249 291\* |
Exec. time (1 core)   |    11 s   |   7.7 min  |      6.6 h      |     15 days    |   *Not measured*  |
Exec. time (6 cores)  |   2.5 s   |   1.4 min  |      1.2 h      |    2.6 days    |   *Not measured*  |
Exec. time (12 cores) |   2.1 s   |   1.3 min  |      1.1 h      |    2.5 days    |   *Not measured*  |

\* Running 128 instances of `geng` on an AMD Ryzen Threadripper 3990X 64-Core Processor for 14 days.


### Laman graphs constructible by Henneberg type I moves
OEIS entry: [A273468](https://oeis.org/A273468 "Number of minimally rigid graphs with n vertices constructible by Henneberg type I moves.")<br/>
Command: `geng $n -H -u`
n                     |     12     |      13     |    14 (new)    |     15 (new)    |      16 (new)     |
----------------------|:----------:|:-----------:|:--------------:|:---------------:|:-----------------:|
H1 Laman graphs       | 23 352 425 | 498 028 767 | 11 836 515 526 | 310 152 665 647 | 8 883 427 573 134 |
Exec. time (1 core)   |    24 s    |    11 min   |      5.4 h     |     7.6 days    |     290 days\*    |

\* Total CPU time of 64 cores on an AMD Ryzen Threadripper 3990X processor.


### Bipartite Laman graphs
OEIS entry: [A328060](https://oeis.org/A328060 "Number of bipartite Laman graphs on n vertices.")<br/>
Command: `geng $n -bK2 -u`
n                      |   13   |     14    |     15     |   16 (new)  |    17 (new)   |     18 (new)    |
-----------------------|:------:|:---------:|:----------:|:-----------:|:-------------:|:---------------:|
Bipartite Laman graphs | 92 539 | 1 210 044 | 17 860 267 | 293 210 063 | 5 277 557 739 | 103 177 250 918 |
Exec. time (1 core)    |  3.4 s |    66 s   |   29 min   |     14 h    |   21 days\*   |   780 days\*\*  |

\* Total CPU time of 6 cores.
\*\* Total CPU time of 64 cores on an AMD Ryzen Threadripper 3990X processor.


### Geiringer graphs
OEIS entry: [A328419](https://oeis.org/A328419 "Number of minimally rigid graphs in 3D on n vertices.")<br/>
Command: `geng $n -K3 -u`

Geiringer graphs, minimally rigid graphs in 3D, are exactly the (3,6)-tight graphs for n=1..7. For larger n the (3,6)-tight graphs form a proper superset of the Geiringer graphs. Consequently, the Geiringer graphs can be found by numerically checking the rigidity of the generated (3,6)-tight graphs.
n                     |   6   |   7   |   8   |    9   |    10   |     11     |        12       |
----------------------|:-----:|:-----:|:-----:|:------:|:-------:|:----------:|:---------------:|
(3,6)-tight graphs    |   4   |   26  |  375  | 11 495 | 613 092 | 48 185 341 |  5 116 473 573  |
Geiringer graphs      |   4   |   26  |  374  | 11 487 | 612 884 | 48 176 183 | 5 115 840 190\* |
Exec. time (1 core)   |       |       |       |  50 ms |  1.7 s  |   3.8 min  |       13 h      |

\* Calculated by numerically checking the rigidity of the generated (3,6)-tight graphs.


### (3/2,2)-tight graphs
OEIS entry: [A233288](https://oeis.org/A233288 "Number of (3/2,2)-tight graphs with 2n vertices, or kinematic chains with 2n links.")<br/>
Command: `geng $n -K3/2L2 -u`
n                     |   2   |   4   |   6   |   8   |   10  |   12   |    14   |     16     |
----------------------|:-----:|:-----:|:-----:|:-----:|:-----:|:------:|:-------:|:----------:|
(3/2,2)-tight graphs  |   1   |   1   |   2   |   16  |  230  |  6 856 | 318 162 | 19 819 281 |
Exec. time (1 core)   |       |       |       |       | 20 ms | 600 ms | 1.1 min |    3.4 h   |


### Pseudoforests
OEIS entry: [A134964](https://oeis.org/A134964 "Number of different unlabeled n-node graphs with at most one cycle in each connected component.")<br/>
Command: `geng $n 0:999 -K1L0 -u`
n                      |    14   |    15   |    16   |     17    |     18    |     19     |     20     |
-----------------------|:-------:|:-------:|:-------:|:---------:|:---------:|:----------:|:----------:|
Pseudoforests          | 101 323 | 282 693 | 793 697 | 2 237 982 | 6 335 978 | 17 992 622 | 51 235 887 |
Exec. time (1 core)    |  5.3 s  |   29 s  | 2.6 min |   15 min  |   1.3 h   |    7.1 h   |  1.8 days  |


### Trees
OEIS entry: [A000055](https://oeis.org/A000055 "Number of trees with n unlabeled nodes.")<br/>
Command: `geng $n -K1 -u`

[Trees](https://en.wikipedia.org/wiki/Tree_(graph_theory)), minimally rigid graphs in 1D, are exactly the (1,1)-tight graphs.
n                      |   15  |   16   |   17   |    18   |    19   |    20   |     21    |     22    |
-----------------------|:-----:|:------:|:------:|:-------:|:-------:|:-------:|:---------:|:---------:|
Trees                  | 7 741 | 19 320 | 48 629 | 123 867 | 317 955 | 823 065 | 2 144 505 | 5 623 756 |
Exec. time (1 core)    | 1.3 s |  6.3 s |  29 s  | 2.1 min |  10 min |  58 min |   4.7 h   |    23 h   |

# Nauty Laman plugin
A plugin for the utility program `geng` provided with [Nauty](http://pallini.di.uniroma1.it/) that enables quick generation of nonisomorphic [sparse and tight graphs](https://en.wikipedia.org/wiki/Dense_graph#Sparse_and_tight_graphs). A graph is (k,l)-sparse if every n-vertex subgraph has at most kn−l edges and (k,l)-tight if it is (k,l)-sparse and has exactly kn−l edges. The (2,3)-tight graphs are exactly the [Laman graphs](https://en.wikipedia.org/wiki/Laman_graph), i.e., the minimally rigid graphs in 2D.


## Installation
1. Download and build [Nauty](http://pallini.di.uniroma1.it/).
2. Clone this repo and copy `prunelaman.h` and `count_laman` to the folder containing Nauty.
3. `geng` has to be rebuilt with the flag `-D'PLUGIN="prunelaman.h"'` to inject the plugin. Add the flag, for example, by manually editing the `makefile` and then rebuild `geng` (e.g. `rm -f geng && make geng`).


## Usage
The plugin adds three new parameters to `geng`:
* `-K#`: generate (k,l)-tight graphs where l = k(k+1)/2. Minimum degree and number of edges will default to k and kn-l, respectively. Sparse graphs can be generated by manually providing the minimum and maximum number of edges.
* `-L#`: provides the l when generating (k,l)-sparse or (k,l)-tight graphs.
* `-H`: generate (k,l)-tight graphs constructible by [Henneberg type I moves](https://en.wikipedia.org/wiki/Laman_graph#Henneberg_construction). k defaults to 2 but can be set using `-K#`. l is always k(k+1)/2.


## Results - counts and execution times
The tables below show the execution time when generating graphs for various number of vertices n. Unless otherwise specified, the tests were run on an 6-core/12-thread Intel® Core™ i7-6800K CPU @ 3.40GHz. Extensions to entries in [OEIS](https://oeis.org/) are marked with *(new)*.


### Laman graphs
OEIS entry: [A227117](https://oeis.org/A227117 "Number of minimally rigid graphs in 2D on n vertices.")<br/>
Command: `geng $n -K2 -u`

When increasing n by one, for large n, the number of graphs increases by a factor of approximately 30 while the execution time increases by a factor of approximately 60. `geng` parallelizes well over physical cores but poorly over logical cores.
n                     |     11    |     12     |        13       |    14 (new)    |      15 (new)     |
----------------------|:---------:|:----------:|:---------------:|:--------------:|:-----------------:|
Laman graphs          | 2 039 273 | 44 176 717 |  1 092 493 042  | 30 322 994 747 | 932 701 249 291\* |
Exec. time (1 core)   |    11 s   |   7.7 min  |      6.6 h      | *Not measured* |   *Not measured*  |
Exec. time (6 cores)  |   2.5 s   |   1.4 min  |      1.2 h      |    2.6 days    |   *Not measured*  |
Exec. time (12 cores) |   2.1 s   |   1.3 min  |      1.1 h      |    2.5 days    |   *Not measured*  |

\* Running 128 instances of `geng` on an AMD Ryzen Threadripper 3990X 64-Core Processor for 14 days.


### Laman graphs constructible by Henneberg type I moves
OEIS entry: [A273468](https://oeis.org/A273468 "Number of minimally rigid graphs with n vertices constructible by Henneberg type I moves.")<br/>
Command: `geng $n -H -u`
n                     |   10   |     11    |     12     |      13     |    14 (new)    |     15 (new)    |
----------------------|:------:|:---------:|:----------:|:-----------:|:--------------:|:---------------:|
H1 Laman graphs       | 75 635 | 1 237 670 | 23 352 425 | 498 028 767 | 11 836 515 526 | 310 152 665 647 |
Exec. time (1 core)   | 140 ms |   1.3 s   |    24 s    |    11 min   |      5.4 h     |    7.7 days\*   |

\* Total CPU time of 6 cores.


### Bipartite Laman graphs
OEIS entry: [A328060](https://oeis.org/A328060 "Number of bipartite Laman graphs on n vertices.")<br/>
Command: `geng $n -bK2 -u`
n                      |   12   |   13   |     14    |     15     |   16 (new)  |    17 (new)   |
-----------------------|:------:|:------:|:---------:|:----------:|:-----------:|:-------------:|
Bipartite Laman graphs |  8 304 | 92 539 | 1 210 044 | 17 860 267 | 293 210 063 | 5 277 557 739 |
Exec. time (1 core)    | 320 ms |  3.4 s |    66 s   |   29 min   |     14 h    |   21 days\*   |

\* Total CPU time of 6 cores.


### Geiringer graphs
OEIS entry: [A328419](https://oeis.org/A328419 "Number of minimally rigid graphs in 3D on n vertices.")<br/>
Command: `geng $n -K3 -u`

Geiringer graphs are graphs minimally rigid in 3D and coincide with the (3,6)-tight graphs for n=1..7. For larger n the (3,6)-tight graphs form a proper superset of the Geiringer graphs.
n                     |   6   |   7   |   8   |    9   |    10   |     11     |        12       |
----------------------|:-----:|:-----:|:-----:|:------:|:-------:|:----------:|:---------------:|
(3,6)-tight graphs    |   4   |   26  |  375  | 11 495 | 613 092 | 48 185 341 |  5 116 473 573  |
Geiringer graphs      |   4   |   26  |  374  | 11 487 | 612 884 | 48 176 183 | 5 115 840 190\* |
Exec. time (1 core)   |       |       |       |  50 ms |  1.7 s  |   3.8 min  |       13 h      |

\* Calculated by numerically checking the rigidity of the generated (3,6)-tight graphs.


### Trees
OEIS entry: [A000055](https://oeis.org/A000055 "Number of trees with n unlabeled nodes.")<br/>
Command: `geng $n -K1L1 -u`
n                      |   13   |   14   |   15  |   16   |   17   |    18   |    19   |    20   |
-----------------------|:------:|:------:|:-----:|:------:|:------:|:-------:|:-------:|:-------:|
Trees                  |  1 301 |  3 159 | 7 741 | 19 320 | 48 629 | 123 867 | 317 955 | 823 065 |
Exec. time (1 core)    | 100 ms | 350 ms | 1.3 s |  6.3 s |  29 s  | 2.1 min |  10 min |  58 min |
